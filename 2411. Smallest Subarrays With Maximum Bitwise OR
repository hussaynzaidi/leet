/**
 * Note: The returned array must be malloced, assume caller calls free().
 */
int* smallestSubarrays(int* nums, int numsSize, int* returnSize) {
   int* res = (int*)malloc(sizeof(int) * numsSize);
    int lastBitPos[32] = {0};
    for (int i = numsSize - 1; i >= 0; i--) {
        for (int b = 0; b < 32; b++) {
            if (nums[i] & (1U << b)) {
                lastBitPos[b] = i;
            }
        }

        int maxReach = i;
        for (int b = 0; b < 32; b++) {
            if (lastBitPos[b] > maxReach) {
                maxReach = lastBitPos[b];
            }
        }

        res[i] = maxReach - i + 1;
    }

    *returnSize = numsSize;
    return res;
}
